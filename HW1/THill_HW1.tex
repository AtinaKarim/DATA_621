% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={HW1\_HillT},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{HW1\_HillT}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'ggplot2' was built under R version 3.6.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'dplyr' was built under R version 3.6.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(readr)}
\KeywordTok{library}\NormalTok{(reshape2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'reshape2' was built under R version 3.6.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(purrr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'purrr' was built under R version 3.6.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(tidyr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'tidyr' was built under R version 3.6.3
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'tidyr'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:reshape2':
## 
##     smiths
\end{verbatim}

\hypertarget{loading-the-initial-data}{%
\subsubsection{Loading the initial
data}\label{loading-the-initial-data}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_df \textless{}{-}}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{\textquotesingle{}moneyball{-}training{-}data.csv\textquotesingle{}}\NormalTok{)}

\KeywordTok{head}\NormalTok{(baseball\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   INDEX TARGET_WINS TEAM_BATTING_H TEAM_BATTING_2B TEAM_BATTING_3B
## 1     1          39           1445             194              39
## 2     2          70           1339             219              22
## 3     3          86           1377             232              35
## 4     4          70           1387             209              38
## 5     5          82           1297             186              27
## 6     6          75           1279             200              36
##   TEAM_BATTING_HR TEAM_BATTING_BB TEAM_BATTING_SO TEAM_BASERUN_SB
## 1              13             143             842              NA
## 2             190             685            1075              37
## 3             137             602             917              46
## 4              96             451             922              43
## 5             102             472             920              49
## 6              92             443             973             107
##   TEAM_BASERUN_CS TEAM_BATTING_HBP TEAM_PITCHING_H TEAM_PITCHING_HR
## 1              NA               NA            9364               84
## 2              28               NA            1347              191
## 3              27               NA            1377              137
## 4              30               NA            1396               97
## 5              39               NA            1297              102
## 6              59               NA            1279               92
##   TEAM_PITCHING_BB TEAM_PITCHING_SO TEAM_FIELDING_E TEAM_FIELDING_DP
## 1              927             5456            1011               NA
## 2              689             1082             193              155
## 3              602              917             175              153
## 4              454              928             164              156
## 5              472              920             138              168
## 6              443              973             123              149
\end{verbatim}

\hypertarget{feature-boxplots-and-histograms}{%
\subsubsection{Feature Boxplots and
Histograms}\label{feature-boxplots-and-histograms}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_df }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{keep}\NormalTok{(is.numeric) }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{gather}\NormalTok{() }\OperatorTok{\%\textgreater{}\%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{facet\_wrap}\NormalTok{(}\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{key, }\DataTypeTok{scales =} \StringTok{"free"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 3478 rows containing non-finite values (stat_boxplot).
\end{verbatim}

\includegraphics{THill_HW1_files/figure-latex/baseball-graphs-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_df }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{keep}\NormalTok{(is.numeric) }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{gather}\NormalTok{() }\OperatorTok{\%\textgreater{}\%}\StringTok{ }
\StringTok{  }\KeywordTok{ggplot}\NormalTok{(}\KeywordTok{aes}\NormalTok{(value)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{facet\_wrap}\NormalTok{(}\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{key, }\DataTypeTok{scales =} \StringTok{"free"}\NormalTok{) }\OperatorTok{+}
\StringTok{    }\KeywordTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
\end{verbatim}

\begin{verbatim}
## Warning: Removed 3478 rows containing non-finite values (stat_bin).
\end{verbatim}

\includegraphics{THill_HW1_files/figure-latex/baseball-graphs-2.pdf}

\hypertarget{summary-statistics}{%
\subsubsection{Summary Statistics}\label{summary-statistics}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(baseball\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      INDEX         TARGET_WINS     TEAM_BATTING_H TEAM_BATTING_2B
##  Min.   :   1.0   Min.   :  0.00   Min.   : 891   Min.   : 69.0  
##  1st Qu.: 630.8   1st Qu.: 71.00   1st Qu.:1383   1st Qu.:208.0  
##  Median :1270.5   Median : 82.00   Median :1454   Median :238.0  
##  Mean   :1268.5   Mean   : 80.79   Mean   :1469   Mean   :241.2  
##  3rd Qu.:1915.5   3rd Qu.: 92.00   3rd Qu.:1537   3rd Qu.:273.0  
##  Max.   :2535.0   Max.   :146.00   Max.   :2554   Max.   :458.0  
##                                                                  
##  TEAM_BATTING_3B  TEAM_BATTING_HR  TEAM_BATTING_BB TEAM_BATTING_SO 
##  Min.   :  0.00   Min.   :  0.00   Min.   :  0.0   Min.   :   0.0  
##  1st Qu.: 34.00   1st Qu.: 42.00   1st Qu.:451.0   1st Qu.: 548.0  
##  Median : 47.00   Median :102.00   Median :512.0   Median : 750.0  
##  Mean   : 55.25   Mean   : 99.61   Mean   :501.6   Mean   : 735.6  
##  3rd Qu.: 72.00   3rd Qu.:147.00   3rd Qu.:580.0   3rd Qu.: 930.0  
##  Max.   :223.00   Max.   :264.00   Max.   :878.0   Max.   :1399.0  
##                                                    NA's   :102     
##  TEAM_BASERUN_SB TEAM_BASERUN_CS TEAM_BATTING_HBP TEAM_PITCHING_H
##  Min.   :  0.0   Min.   :  0.0   Min.   :29.00    Min.   : 1137  
##  1st Qu.: 66.0   1st Qu.: 38.0   1st Qu.:50.50    1st Qu.: 1419  
##  Median :101.0   Median : 49.0   Median :58.00    Median : 1518  
##  Mean   :124.8   Mean   : 52.8   Mean   :59.36    Mean   : 1779  
##  3rd Qu.:156.0   3rd Qu.: 62.0   3rd Qu.:67.00    3rd Qu.: 1682  
##  Max.   :697.0   Max.   :201.0   Max.   :95.00    Max.   :30132  
##  NA's   :131     NA's   :772     NA's   :2085                    
##  TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO  TEAM_FIELDING_E 
##  Min.   :  0.0    Min.   :   0.0   Min.   :    0.0   Min.   :  65.0  
##  1st Qu.: 50.0    1st Qu.: 476.0   1st Qu.:  615.0   1st Qu.: 127.0  
##  Median :107.0    Median : 536.5   Median :  813.5   Median : 159.0  
##  Mean   :105.7    Mean   : 553.0   Mean   :  817.7   Mean   : 246.5  
##  3rd Qu.:150.0    3rd Qu.: 611.0   3rd Qu.:  968.0   3rd Qu.: 249.2  
##  Max.   :343.0    Max.   :3645.0   Max.   :19278.0   Max.   :1898.0  
##                                    NA's   :102                       
##  TEAM_FIELDING_DP
##  Min.   : 52.0   
##  1st Qu.:131.0   
##  Median :149.0   
##  Mean   :146.4   
##  3rd Qu.:164.0   
##  Max.   :228.0   
##  NA's   :286
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{colSums}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(baseball\_df))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            INDEX      TARGET_WINS   TEAM_BATTING_H  TEAM_BATTING_2B 
##                0                0                0                0 
##  TEAM_BATTING_3B  TEAM_BATTING_HR  TEAM_BATTING_BB  TEAM_BATTING_SO 
##                0                0                0              102 
##  TEAM_BASERUN_SB  TEAM_BASERUN_CS TEAM_BATTING_HBP  TEAM_PITCHING_H 
##              131              772             2085                0 
## TEAM_PITCHING_HR TEAM_PITCHING_BB TEAM_PITCHING_SO  TEAM_FIELDING_E 
##                0                0              102                0 
## TEAM_FIELDING_DP 
##              286
\end{verbatim}

\hypertarget{fitting-a-linear-model}{%
\subsubsection{Fitting a Linear Model}\label{fitting-a-linear-model}}

My first change to the data was to eliminate the index and two problem
variables with many misisng variables: when batters are hit by pitch or
caught stealing.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_df\_fix \textless{}{-}}\StringTok{ }\KeywordTok{subset}\NormalTok{(baseball\_df, }\DataTypeTok{select =} \OperatorTok{{-}}\KeywordTok{c}\NormalTok{(TEAM\_BATTING\_HBP,TEAM\_BASERUN\_CS, INDEX))}

\NormalTok{baseball\_lm \textless{}{-}}\StringTok{ }\KeywordTok{lm}\NormalTok{(baseball\_df\_fix, }\DataTypeTok{formula =}\NormalTok{ TARGET\_WINS }\OperatorTok{\textasciitilde{}}\StringTok{  }\NormalTok{TEAM\_PITCHING\_H }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_PITCHING\_HR }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_FIELDING\_DP }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_3B }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_H}\OperatorTok{:}\NormalTok{TEAM\_BATTING\_HR }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_2B}\OperatorTok{:}\NormalTok{TEAM\_BATTING\_HR}\OperatorTok{+}\StringTok{ }\KeywordTok{log}\NormalTok{(TEAM\_FIELDING\_E) }\OperatorTok{+}\StringTok{ }\KeywordTok{log}\NormalTok{(TEAM\_PITCHING\_BB) }\OperatorTok{+}\StringTok{ }\KeywordTok{log}\NormalTok{(TEAM\_PITCHING\_SO) }\OperatorTok{+}\StringTok{ }\KeywordTok{log}\NormalTok{(TEAM\_BASERUN\_SB))}

\KeywordTok{summary}\NormalTok{(baseball\_lm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = TARGET_WINS ~ TEAM_PITCHING_H + TEAM_PITCHING_HR + 
##     TEAM_FIELDING_DP + TEAM_BATTING_3B + TEAM_BATTING_H:TEAM_BATTING_HR + 
##     TEAM_BATTING_2B:TEAM_BATTING_HR + log(TEAM_FIELDING_E) + 
##     log(TEAM_PITCHING_BB) + log(TEAM_PITCHING_SO) + log(TEAM_BASERUN_SB), 
##     data = baseball_df_fix)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -32.251  -7.220   0.246   7.366  30.338 
## 
## Coefficients:
##                                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                      1.273e+02  1.784e+01   7.137 1.37e-12 ***
## TEAM_PITCHING_H                  6.416e-03  1.998e-03   3.211  0.00135 ** 
## TEAM_PITCHING_HR                -1.139e-01  2.792e-02  -4.080 4.71e-05 ***
## TEAM_FIELDING_DP                -1.186e-01  1.229e-02  -9.649  < 2e-16 ***
## TEAM_BATTING_3B                  1.998e-01  1.905e-02  10.490  < 2e-16 ***
## log(TEAM_FIELDING_E)            -2.043e+01  1.291e+00 -15.823  < 2e-16 ***
## log(TEAM_PITCHING_BB)            1.849e+01  1.639e+00  11.279  < 2e-16 ***
## log(TEAM_PITCHING_SO)           -1.413e+01  1.714e+00  -8.244 3.14e-16 ***
## log(TEAM_BASERUN_SB)             5.064e+00  5.363e-01   9.442  < 2e-16 ***
## TEAM_BATTING_H:TEAM_BATTING_HR   2.337e-04  2.351e-05   9.942  < 2e-16 ***
## TEAM_BATTING_HR:TEAM_BATTING_2B -5.488e-04  6.655e-05  -8.247 3.07e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10.34 on 1824 degrees of freedom
##   (441 observations deleted due to missingness)
## Multiple R-squared:  0.3864, Adjusted R-squared:  0.383 
## F-statistic: 114.9 on 10 and 1824 DF,  p-value: < 2.2e-16
\end{verbatim}

Next, I considered looking at interactions between total hits and
singles, doubles, triples, and home runs.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_interactions \textless{}{-}}\StringTok{ }\KeywordTok{lm}\NormalTok{(baseball\_df\_fix, }\DataTypeTok{formula =}\NormalTok{ TARGET\_WINS }\OperatorTok{\textasciitilde{}}\StringTok{ }\NormalTok{(TEAM\_BATTING\_H }\OperatorTok{*}\StringTok{ }\NormalTok{TEAM\_BATTING\_2B }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_H }\OperatorTok{*}\StringTok{ }\NormalTok{TEAM\_BATTING\_3B }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_H }\OperatorTok{*}\StringTok{ }\NormalTok{TEAM\_BATTING\_HR))}

\KeywordTok{summary}\NormalTok{(baseball\_interactions)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = TARGET_WINS ~ (TEAM_BATTING_H * TEAM_BATTING_2B + 
##     TEAM_BATTING_H * TEAM_BATTING_3B + TEAM_BATTING_H * TEAM_BATTING_HR), 
##     data = baseball_df_fix)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -68.807  -8.816   0.569   9.585  58.270 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                    -7.961e+00  1.291e+01  -0.616 0.537654    
## TEAM_BATTING_H                  4.868e-02  9.039e-03   5.386 7.97e-08 ***
## TEAM_BATTING_2B                -2.802e-02  5.708e-02  -0.491 0.623581    
## TEAM_BATTING_3B                 4.678e-01  1.016e-01   4.605 4.34e-06 ***
## TEAM_BATTING_HR                 2.462e-01  6.928e-02   3.553 0.000388 ***
## TEAM_BATTING_H:TEAM_BATTING_2B  2.323e-05  3.814e-05   0.609 0.542590    
## TEAM_BATTING_H:TEAM_BATTING_3B -2.231e-04  6.497e-05  -3.434 0.000606 ***
## TEAM_BATTING_H:TEAM_BATTING_HR -1.108e-04  4.622e-05  -2.397 0.016596 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 14.05 on 2268 degrees of freedom
## Multiple R-squared:  0.2074, Adjusted R-squared:  0.2049 
## F-statistic: 84.77 on 7 and 2268 DF,  p-value: < 2.2e-16
\end{verbatim}

In the histograms above, I noticed some of the data was bimodal in some
cases. I approximated some dummy variables to see if they added to the
linear model. This part ended up being a dead end and I'll instead use
the Box-Cox method to transform these variables later in the week.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_dummies \textless{}{-}}\StringTok{ }\NormalTok{baseball\_df\_fix }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{TEAM\_PITCHING\_HR\_70 =} \KeywordTok{case\_when}\NormalTok{(TEAM\_PITCHING\_HR }\OperatorTok{\textless{}=}\StringTok{ }\DecValTok{70} \OperatorTok{\textasciitilde{}}\StringTok{ }\DecValTok{1}\NormalTok{, TEAM\_PITCHING\_HR }\OperatorTok{\textgreater{}}\StringTok{ }\DecValTok{70} \OperatorTok{\textasciitilde{}}\StringTok{ }\DecValTok{0}\NormalTok{)) }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{TEAM\_BATTING\_SO\_750 =} \KeywordTok{case\_when}\NormalTok{(TEAM\_BATTING\_SO  }\OperatorTok{\textgreater{}}\StringTok{ }\DecValTok{750} \OperatorTok{\textasciitilde{}}\StringTok{ }\DecValTok{1}\NormalTok{, (TEAM\_BATTING\_SO  }\OperatorTok{\textless{}=}\StringTok{ }\DecValTok{750} \OperatorTok{|}\StringTok{ }\KeywordTok{is.na}\NormalTok{(TEAM\_BATTING\_SO)) }\OperatorTok{\textasciitilde{}}\StringTok{ }\DecValTok{0}\NormalTok{)) }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{TEAM\_BATTING\_HR\_60 =} \KeywordTok{case\_when}\NormalTok{(TEAM\_BATTING\_HR  }\OperatorTok{\textgreater{}}\StringTok{ }\DecValTok{60} \OperatorTok{\textasciitilde{}}\StringTok{ }\DecValTok{1}\NormalTok{, TEAM\_BATTING\_HR  }\OperatorTok{\textless{}=}\StringTok{ }\DecValTok{60} \OperatorTok{\textasciitilde{}}\StringTok{ }\DecValTok{0}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\hypertarget{final-model-using-all-training-ddata}{%
\subsubsection{Final Model using all Training
Ddata}\label{final-model-using-all-training-ddata}}

For my final model I considered, I originally modeled all of the dummy
variables but they ended up not contributing anything to the model. This
final model eliminates several features altogether, transforms three,
and considers four different interaction effects.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_lm2 \textless{}{-}}\StringTok{ }\KeywordTok{lm}\NormalTok{(baseball\_df\_fix, }\DataTypeTok{formula =}\NormalTok{ TARGET\_WINS }\OperatorTok{\textasciitilde{}}\NormalTok{. }\OperatorTok{+}\KeywordTok{log}\NormalTok{(TEAM\_FIELDING\_E) }\OperatorTok{+}\KeywordTok{log}\NormalTok{(TEAM\_PITCHING\_SO) }\OperatorTok{+}\StringTok{ }\KeywordTok{log}\NormalTok{(TEAM\_BASERUN\_SB) }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_3B}\OperatorTok{:}\NormalTok{TEAM\_BATTING\_HR }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_2B}\OperatorTok{:}\NormalTok{TEAM\_BATTING\_HR }\OperatorTok{+}\StringTok{  }\NormalTok{TEAM\_BATTING\_H}\OperatorTok{:}\NormalTok{TEAM\_BATTING\_HR }\OperatorTok{+}\StringTok{ }\NormalTok{TEAM\_BATTING\_H}\OperatorTok{:}\NormalTok{TEAM\_BATTING\_3B}\OperatorTok{{-}}\StringTok{ }\NormalTok{TEAM\_BATTING\_3B }\OperatorTok{{-}}\StringTok{ }\NormalTok{TEAM\_BATTING\_SO }\OperatorTok{{-}}\StringTok{ }\NormalTok{TEAM\_BATTING\_2B}\OperatorTok{{-}}\NormalTok{TEAM\_BATTING\_BB}\OperatorTok{{-}}\NormalTok{TEAM\_BATTING\_HR}\OperatorTok{{-}}\NormalTok{TEAM\_BATTING\_H}\OperatorTok{{-}}\NormalTok{TEAM\_BATTING\_HR}\OperatorTok{{-}}\StringTok{ }\NormalTok{TEAM\_PITCHING\_HR)}


\KeywordTok{summary}\NormalTok{(baseball\_lm2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = TARGET_WINS ~ . + log(TEAM_FIELDING_E) + log(TEAM_PITCHING_SO) + 
##     log(TEAM_BASERUN_SB) + TEAM_BATTING_3B:TEAM_BATTING_HR + 
##     TEAM_BATTING_2B:TEAM_BATTING_HR + TEAM_BATTING_H:TEAM_BATTING_HR + 
##     TEAM_BATTING_H:TEAM_BATTING_3B - TEAM_BATTING_3B - TEAM_BATTING_SO - 
##     TEAM_BATTING_2B - TEAM_BATTING_BB - TEAM_BATTING_HR - TEAM_BATTING_H - 
##     TEAM_BATTING_HR - TEAM_PITCHING_HR, data = baseball_df_fix)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -32.369  -6.994   0.202   6.859  29.847 
## 
## Coefficients:
##                                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                      8.746e-01  4.314e+01   0.020 0.983829    
## TEAM_BASERUN_SB                  9.452e-02  1.557e-02   6.072 1.54e-09 ***
## TEAM_PITCHING_H                  4.775e-03  2.058e-03   2.320 0.020446 *  
## TEAM_PITCHING_BB                 3.036e-02  2.836e-03  10.705  < 2e-16 ***
## TEAM_PITCHING_SO                -5.275e-02  7.697e-03  -6.854 9.80e-12 ***
## TEAM_FIELDING_E                 -5.201e-02  2.103e-02  -2.473 0.013474 *  
## TEAM_FIELDING_DP                -1.119e-01  1.220e-02  -9.179  < 2e-16 ***
## log(TEAM_FIELDING_E)            -1.290e+01  3.897e+00  -3.312 0.000945 ***
## log(TEAM_PITCHING_SO)            2.552e+01  6.367e+00   4.008 6.38e-05 ***
## log(TEAM_BASERUN_SB)            -3.154e+00  1.457e+00  -2.165 0.030491 *  
## TEAM_BATTING_3B:TEAM_BATTING_HR -8.208e-04  2.619e-04  -3.134 0.001752 ** 
## TEAM_BATTING_2B:TEAM_BATTING_HR -3.967e-04  6.568e-05  -6.040 1.86e-09 ***
## TEAM_BATTING_H:TEAM_BATTING_HR   1.553e-04  1.565e-05   9.924  < 2e-16 ***
## TEAM_BATTING_H:TEAM_BATTING_3B   1.823e-04  1.875e-05   9.722  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 10.11 on 1821 degrees of freedom
##   (441 observations deleted due to missingness)
## Multiple R-squared:  0.4144, Adjusted R-squared:  0.4102 
## F-statistic: 99.11 on 13 and 1821 DF,  p-value: < 2.2e-16
\end{verbatim}

The R-squared statistic indicates that this model predicts less than
half of the variation in wins with the included features. For a next
step, I hope to use cross-validation techniques to split the training
data further and allow me to compare RMSE of various models.

\hypertarget{evaluation-data}{%
\subsubsection{Evaluation Data}\label{evaluation-data}}

I also loaded the evaluation data and predicted the wins using my final
model. Since the actual wins are withheld, I compared the distribution
of predictions to the actual wins in the training set. The means were
similar but the training data included much more variation between
teams. It's also worth mentioning as well that using the predict
function creates missing values as the evaluation data is missing. In
fact, for TEAM\_BATTING\_HBP, over 90\% of rows are missing entries.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_eval \textless{}{-}}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{\textquotesingle{}moneyball{-}evaluation{-}data.csv\textquotesingle{}}\NormalTok{)}

\KeywordTok{colSums}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(baseball\_eval))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            INDEX   TEAM_BATTING_H  TEAM_BATTING_2B  TEAM_BATTING_3B 
##                0                0                0                0 
##  TEAM_BATTING_HR  TEAM_BATTING_BB  TEAM_BATTING_SO  TEAM_BASERUN_SB 
##                0                0               18               13 
##  TEAM_BASERUN_CS TEAM_BATTING_HBP  TEAM_PITCHING_H TEAM_PITCHING_HR 
##               87              240                0                0 
## TEAM_PITCHING_BB TEAM_PITCHING_SO  TEAM_FIELDING_E TEAM_FIELDING_DP 
##                0               18                0               31
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{baseball\_vars \textless{}{-}}\StringTok{ }\NormalTok{baseball\_eval }\OperatorTok{\%\textgreater{}\%}
\StringTok{  }\KeywordTok{select}\NormalTok{(TEAM\_PITCHING\_H, TEAM\_PITCHING\_HR, TEAM\_FIELDING\_DP, TEAM\_BATTING\_3B, TEAM\_FIELDING\_E, TEAM\_PITCHING\_BB, TEAM\_PITCHING\_SO, TEAM\_BASERUN\_SB, TEAM\_BATTING\_H, TEAM\_BATTING\_HR, TEAM\_BATTING\_2B)}

\NormalTok{eval\_predict \textless{}{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(baseball\_interactions, }\DataTypeTok{newdata =}\NormalTok{ baseball\_eval)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(baseball\_df}\OperatorTok{$}\NormalTok{TARGET\_WINS)}
\end{Highlighting}
\end{Shaded}

\includegraphics{THill_HW1_files/figure-latex/training-vs-eval-wins-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(eval\_predict)}
\end{Highlighting}
\end{Shaded}

\includegraphics{THill_HW1_files/figure-latex/training-vs-eval-wins-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(eval\_predict)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   54.33   75.52   80.85   80.47   85.46  102.01
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(eval\_predict)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 7.711588
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(baseball\_df}\OperatorTok{$}\NormalTok{TARGET\_WINS)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   71.00   82.00   80.79   92.00  146.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(baseball\_df}\OperatorTok{$}\NormalTok{TARGET\_WINS)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.75215
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{eval\_predict2 \textless{}{-}}\StringTok{ }\KeywordTok{predict}\NormalTok{(baseball\_lm2, }\DataTypeTok{newdata =}\NormalTok{ baseball\_eval)}

\KeywordTok{hist}\NormalTok{(baseball\_df}\OperatorTok{$}\NormalTok{TARGET\_WINS, }\DataTypeTok{breaks =} \DecValTok{40}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{THill_HW1_files/figure-latex/training-vs-eval-wins2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(eval\_predict2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{THill_HW1_files/figure-latex/training-vs-eval-wins2-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summary}\NormalTok{(eval\_predict2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##   53.70   74.52   80.91   81.02   87.53  114.55      54
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(eval\_predict2, }\DataTypeTok{na.rm =}\NormalTok{ T)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.932411
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{n\_test \textless{}{-}}\KeywordTok{nrow}\NormalTok{(baseball\_eval)}
\NormalTok{n\_train \textless{}{-}}\StringTok{ }\KeywordTok{nrow}\NormalTok{(baseball\_df)}

\KeywordTok{summary}\NormalTok{(baseball\_df}\OperatorTok{$}\NormalTok{TARGET\_WINS)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   71.00   82.00   80.79   92.00  146.00
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{sd}\NormalTok{(baseball\_df}\OperatorTok{$}\NormalTok{TARGET\_WINS)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.75215
\end{verbatim}

\end{document}
